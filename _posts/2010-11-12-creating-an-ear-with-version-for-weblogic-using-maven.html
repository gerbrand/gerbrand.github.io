---
layout: post
title: Creating an ear with version for Weblogic using Maven
date: 2010-11-12 11:35:28.000000000 +01:00
type: post
published: true
status: publish
categories:
- Technology
tags:
- java
meta:
  _edit_last: '2'
  _wp_old_slug: ''
  _icl_translator_note: ''
  dsq_thread_id: '3768853547'
  _jetpack_related_posts_cache: a:0:{}
author:
  login: admin
  email: gerbrand@vandieijen.nl
  display_name: gerbrand
  first_name: Gerbrand
  last_name: van Dieijen
---
<p>Using the <a href="http://maven.apache.org/plugins/maven-ear-plugin/">ear plugin</a> of Maven 2 creating an ear is very easy. The produced ear follows the JEE spec, so you can normally use it in any application server.<br />
I'm using the ear plugin as well, in my case to be used for Weblogic 9. Weblogic has a feature that allows you to update applications on the fly using the Deployments, update command. However, to be able to use that feature well, the MANIFEST file of the ear has to include a Weblogic specific version field called <em>WebLogic-Application-Version</em>, with a unique version for each ear you'd want to include. Without the version number, Weblogic will list the application twice in the weblogic administration console.</p>
<p><!--more--> Adding a custom manifest entry is quite easy. Just add an entry to the configuration of the Maven 2 ear plugin, as shown in the example below:</p>
<pre>&lt;plugin&gt;
&lt;artifactId&gt;maven-ear-plugin&lt;/artifactId&gt;
&lt;configuration&gt;
&lt;archive&gt;
&lt;manifestEntries&gt;
&lt;WebLogic-Application-Version&gt;${project.version}&lt;/WebLogic-Application-Version&gt;
&lt;/manifestEntries&gt;
&lt;/archive&gt;
...
&lt;/plugin&gt;</pre>
<p>This will cause the Manifest file to contain an entry WebLogic-Application-Version containing the current version of your Maven project.<br />
However, this wasn't enough for me: I'm sometimes modifying and recreating the ear multiple times per day during development. The maven project version remains the same, which means Weblogic won't see my new development ear as a new version.<br />
The solution is to include a timestamp in the version as well. By default, Maven doesn't include a timestamp. Fortunately there's <a href="http://stackoverflow.com/questions/1224359/how-do-i-add-time-stamp-information-to-maven-artifacts">Stackoverflow</a> with the answer: there's an external plugin called <a href="http://mojo.codehaus.org/buildnumber-maven-plugin/index.html">buildnumber-maven-plugin</a> that allows you do that.<br />
For my weblogic specific entry I added the following to the pom.xml file:</p>
<pre>&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
&lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
&lt;version&gt;1.0-beta-3&lt;/version&gt;
&lt;configuration&gt;
&lt;format&gt;{0,date,yyyyMMddHHmmss}&lt;/format&gt;
&lt;items&gt;
&lt;item&gt;timestamp&lt;/item&gt;
&lt;/items&gt;
&lt;/configuration&gt;
&lt;executions&gt;
&lt;execution&gt;
&lt;phase&gt;validate&lt;/phase&gt;
&lt;goals&gt;
&lt;goal&gt;create&lt;/goal&gt;
&lt;/goals&gt;
&lt;/execution&gt;
&lt;/executions&gt;
&lt;/plugin&gt;</pre>
<p>The above entry will make a variable buildNumber available during build containing a timestamp.<br />
The maven ear configuration becomes:</p>
<pre>&lt;plugin&gt;
&lt;artifactId&gt;maven-ear-plugin&lt;/artifactId&gt;
&lt;configuration&gt;
&lt;archive&gt;
&lt;manifestEntries&gt;
&lt;!-- Buildnumber property is generated by buildnumber-maven-plugin,
see above --&gt;
&lt;WebLogic-Application-Version&gt;${project.version}_${buildNumber}&lt;/WebLogic-Application-Version&gt;
&lt;/manifestEntries&gt;
&lt;/archive&gt;
...
&lt;/plugin&gt;</pre>
<p>After installation in Weblogic using the admin console, weblogic now lists the version number, date and time after I install my ear. Upgrading the application won't result in two applications being listed.</p>
<p>﻿﻿﻿﻿</p>
